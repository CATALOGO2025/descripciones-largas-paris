<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<title>üì¶ Creador de Descripciones Largas</title>
<script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.17.0/xlsx.full.min.js"></script>
<script>

// --- Helpers robustos para URL de Marca (idempotente) ---
if (typeof cleanCell !== 'function') {
  function cleanCell(v){
    return String(v||'').replace(/\u00A0/g,' ').replace(/[‚Äú‚Äù"']/g,'').trim();
  }
}
if (typeof buildMarcaUrl !== 'function') {
  function buildMarcaUrl(v) {
  if (!v) return "";
  const t = String(v).trim();
  if (/^https?:\/\//i.test(t)) return t; // URL completa
  const fileOnly = t.replace(/^.*[\\/]/, "").replace(/[?#].*$/, "");
  // Defaults si no existen las constantes globales
  const part1 = (typeof MARCA_IMG_PART1 !== 'undefined') ? MARCA_IMG_PART1 : 'https://www.paris.cl/images/Contenido%20Fichas/Logos/';
  const part2 = (typeof MARCA_IMG_PART2 !== 'undefined') ? MARCA_IMG_PART2 : '?$staticlink$';
  return part1 + encodeURIComponent(fileOnly) + part2;
}
}


// --- Prefijo/sufijo para Im√°genes Diferenciadoras ---
const DIF_IMG_PART1 = "https://www.paris.cl/images/Contenido%20Fichas/Diferenciadores/";
const DIF_IMG_PART2 = "";

// Construye URL para iconos a partir de nombre de archivo (sin ?$staticlink$)
function buildIconUrl(nameOrUrl){
  const s = String(nameOrUrl||'').trim();
  if (!s) return '';
  // si pegaron URL completa, devolver tal cual
  if (/^https?:\/\//i.test(s)) return s;
  const fileOnly = s.replace(/^.*[\\/]/, '').replace(/[?#].*$/, '');
  return `${DIF_IMG_PART1}${encodeURIComponent(fileOnly)}`;
}

// Construye URL de diferenciador por patr√≥n Dif_{SKU}_{idx}.webp
function buildDiferenciadorUrl(sku, idx){
  const s = String(sku||'').trim();
  const i = String(idx||'').trim();
  if (!s || !i) return '';
  return `${DIF_IMG_PART1}Dif_${s}_${i}.webp`;
}
function buildDifUrl(v) {
  if (!v) return "";
  const trimmed = String(v).trim();
  if (/^https?:\/\//i.test(trimmed)) return trimmed;
  const fileOnly = trimmed.replace(/^.*[\/]/, "").replace(/[?#].*$/, "");
  const ext = (fileOnly.split(".").pop() || "").toLowerCase();
  const allowed = ["webp","jpg","jpeg"]; // acepta .webp y .jpg (.jpeg)
  if (!allowed.includes(ext)) console.warn("Extensi√≥n no habitual en Imagen diferenciadora:", ext);
  return DIF_IMG_PART1 + encodeURIComponent(fileOnly) + DIF_IMG_PART2;
}


function flashDownloadOk() {
  try {
    var btn = document.getElementById('btnDescargarPlantilla');
    if (!btn) return;
    // Preserve width to avoid layout shift
    var w = btn.offsetWidth;
    btn.style.minWidth = w + 'px';
    var oldHTML = btn.innerHTML;
    btn.disabled = true;
    btn.innerHTML = '‚úì Descargado';
    setTimeout(function(){
      btn.innerHTML = oldHTML;
      btn.disabled = false;
      btn.style.minWidth = '';
    }, 1800);
  } catch(e) { /* silent */ }
}



// === URL remota OVERRIDE (opcional). Si est√° definida y accesible, se usa primero.
const PLANTILLA_REMOTE_URL = "";



// === Plantilla Excel embebida (base64) ===
const PLANTILLA_XLSX_FILENAME = "Plantilla_Descripciones.xlsx";
// === Iconos de diferenciadores ===
const ICONO_URLS = {
  "Cruelty Free": "https://www.paris.cl/images/Contenido%20Fichas/Diferenciadores/icono-crueltyfree.png",
  "Libre de Pesticidas": "https://www.paris.cl/images/Contenido%20Fichas/Diferenciadores/icono-libre-pesticidas.png",
  "No Probado en Animales": "https://www.paris.cl/images/Contenido%20Fichas/Diferenciadores/icono-no-probado-animales.png",
  "No Toxico": "https://www.paris.cl/images/Contenido%20Fichas/Diferenciadores/icono-no-toxico.png",
  "Probado Lab": "https://www.paris.cl/images/Contenido%20Fichas/Diferenciadores/icono-probado-lab.png",
  "Sin Aceite": "https://www.paris.cl/images/Contenido%20Fichas/Diferenciadores/icono-sin-aceite.png",
  "Sin Parabenos": "https://www.paris.cl/images/Contenido%20Fichas/Diferenciadores/icono-sin-parabenos.png",
  "Sin Sulfatos": "https://www.paris.cl/images/Contenido%20Fichas/Diferenciadores/icono-sin-sulfatos.png",
  "Vegano": "https://www.paris.cl/images/Contenido%20Fichas/Diferenciadores/icono-vegano.png"
};
const ICONO_OPTIONS = Object.keys(ICONO_URLS);

function pickIconValues(row) {
  const raw = [
    (row["Icono 1"] || "").trim(),
    (row["Icono 2"] || "").trim(),
    (row["Icono 3"] || "").trim(),
    (row["Icono 4"] || "").trim(),
    (row["Icono 5"] || "").trim(),
    (row["Icono 6"] || "").trim()
  ].filter(Boolean);
  const unique = raw.filter((v, i) => raw.indexOf(v) === i);
  return unique.filter(v => ICONO_OPTIONS.includes(v));
}

function renderIconosVisual(iconosArr) {
  if (!iconosArr || !iconosArr.length) return "";
  const imgs = iconosArr.map(label => {
    const src = ICONO_URLS[label];
    const alt = label;
    return `<img src="${src}" alt="${alt}" title="${alt}">`;
  }).join("");
  return `<div class="iconos-wrap">${imgs}</div>`;
}


function renderIconosExport(iconosArr) {
  if (!iconosArr || !iconosArr.length) return "";
  const imgs = iconosArr.map(label => {
    const src = ICONO_URLS[label];
    const alt = label;
    return `<img src="${src}" alt="${alt}" title="${alt}" style='width:72px;height:72px;border-radius:50%;object-fit:contain;display:inline-block;margin-right:12px;'>`;
  }).join("");
  const divider = `<div style="height:1px;background:#e5e7eb;margin:10px 0;"></div>`;
  return `${divider}<div style="display:flex;flex-wrap:wrap;align-items:center;margin:6px 0 14px 20px;">${imgs}</div>${divider}`;
}

const PLANTILLA_XLSX_B64 = "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";






async function downloadTemplate() {
  const statusEl = document.getElementById('tplStatus');
  if (statusEl) { statusEl.style.display = 'none'; statusEl.textContent = ''; }

  const filename = (typeof PLANTILLA_XLSX_FILENAME === 'string' && PLANTILLA_XLSX_FILENAME) ? PLANTILLA_XLSX_FILENAME : "Plantilla_Descripciones.xlsx";

  async function tryFetch(url) {
    try {
      const r = await fetch(url, { cache: "no-store" });
      if (!r.ok) throw new Error("HTTP " + r.status);
      const b = await r.blob();
      const u = URL.createObjectURL(b);
      const a = Object.assign(document.createElement('a'), { href: u, download: filename });
      document.body.appendChild(a); a.click(); URL.revokeObjectURL(u); a.remove();
      // Success UI feedback
      flashDownloadOk();
      return true;
    } catch (e) {
      console.warn("Descarga remota fallida:", url, e && e.message ? e.message : e);
      return false;
    }
  }

  // Orden de intento: Override ‚Üí Absoluta ‚Üí Relativa ‚Üí Fallback embebido
  if (typeof PLANTILLA_REMOTE_URL === "string" && PLANTILLA_REMOTE_URL) {
    const ok0 = await tryFetch(PLANTILLA_REMOTE_URL);
    if (ok0) return;
  }

  const absUrl = "https://catalogo2025.github.io/consultor-para-pruebas/assets/" + filename + "?v=" + Date.now();
  if (await tryFetch(absUrl)) return;

  const relUrl = new URL("assets/" + filename + "?v=" + Date.now(), window.location.href).href;
  if (await tryFetch(relUrl)) return;

  // Fallback embebido
  try {
    if (typeof PLANTILLA_XLSX_B64 === "string" && PLANTILLA_XLSX_B64.length > 0) {
      const byteChars = atob(PLANTILLA_XLSX_B64);
      const byteNumbers = new Array(byteChars.length);
      for (let i = 0; i < byteChars.length; i++) byteNumbers[i] = byteChars.charCodeAt(i);
      const blob = new Blob([new Uint8Array(byteNumbers)], { type: "application/vnd.openxmlformats-officedocument.spreadsheetml.sheet" });
      const url = URL.createObjectURL(blob);
      const a = Object.assign(document.createElement('a'), { href: url, download: filename });
      document.body.appendChild(a); a.click(); URL.revokeObjectURL(url); a.remove();
      flashDownloadOk();
      return;
    }
  } catch (e) {
    console.error("Fallback embebido fall√≥:", e);
  }

  alert("No se pudo descargar la plantilla. Verifica que exista en /assets o que el fallback est√© embebido.");
}








window.onerror=function(m,s,l,c,e){alert('‚ö†Ô∏è Error JS '+m+' ['+l+':'+c+']');};


function cleanForCSV(html) {
  if (html == null) return '';
  // Reemplazar comillas dobles por comillas simples para no romper el parser que espera ';' o nueva l√≠nea
  return String(html).replace(/"/g, "'");
}

function formatDescripcionHTML(textoPlano) {
    if (!textoPlano) return '';
    let t = String(textoPlano).replace(/\r\n/g, '\n').replace(/\r/g, '\n');
    // Forzar '##' a nueva l√≠nea si viene pegado
    t = t.replace(/([^\n])##/g, '$1\n##');
    // Negritas con *...*
    t = t.replace(/\*(.*?)\*/g, '<b>$1</b>');

    const lines = t.split('\n');
    let out = [];
    for (let i = 0; i < lines.length; ) {
        let line = lines[i];

        // Encabezado "## T√≠tulo" -> una sola separaci√≥n antes
        const h = line.match(/^##\s*(.+)/);
        if (h) {
            const hdr = '<h4 style="margin:0;"><b>' + h[1].trim() + '</b></h4>';
            if (out.length > 0 && out[out.length - 1] !== '<br>') out.push('<br>'); // un solo salto antes del t√≠tulo
            out.push(hdr);
            i++;
            continue;
        }

        // Bloques de lista con "- "
        if (/^\s*-\s+/.test(line)) {
            let items = [];
            while (i < lines.length && /^\s*-\s+(.+)$/.test(lines[i])) {
                items.push(lines[i].replace(/^\s*-\s+/, '').trim());
                i++;
            }
            out.push("<ul class='ul-text'>" + items.map(li => "<li>" + li + "</li>").join("") + "</ul>");
            continue;
        }

        // Listas separadas por punto y coma
        if (line.includes(';')) {
            const items = line.split(';').map(s => s.trim()).filter(Boolean);
            if (items.length >= 2) {
                out.push("<ul class='ul-text'>" + items.map(li => "<li>" + li + "</li>").join("") + "</ul>");
                i++;
                continue;
            }
        }

        // L√≠nea en blanco -> garantizar un SOLO <br> entre p√°rrafos
        if (!line.trim()) {
            if (out.length > 0 && out[out.length - 1] !== '<br>') out.push('<br>');
            i++;
            continue;
        }

        // L√≠nea normal
        out.push(line.trim());
        i++;
    }

    // Unir con <br> y limpiar m√∫ltiplos
    let html = out.join('<br>');
    html = cleanForCSV(html);

    // Quitar <br> inmediatamente despu√©s de un </h4>
    html = html.replace(/<\/h4><br>/g, '</h4>');
    // Colapsar m√∫ltiples <br> en uno solo
    html = html.replace(/(<br>\s*){2,}/g, '<br>');
    return html;
}
function formatMetaDescripcion(texto) {
    if (!texto) return '';
    const style = "margin:6px 0; background:#f4f6f7; color:#333; font-size:15px; padding:12px 20px; border-radius:8px; font-weight:normal; line-height:1.6;";
    const bloques = String(texto).trim().split(/\r?\n\r?\n/);
    return bloques.map(b => `<p style='${style}'>${b.replace(/\r?\n/g, '<br>')}</p>`).join('');
}
function cleanYoutubeUrl(url) {
    if (!url) return '';
    let cleanUrl = url.trim();
    if (cleanUrl.includes('youtu.be/')) {
        cleanUrl = cleanUrl.split('?')[0];
        const videoId = cleanUrl.split('youtu.be/')[1];
        return `https://www.youtube.com/embed/${videoId}`;
    }
    if (cleanUrl.includes('watch?v=')) {
        cleanUrl = cleanUrl.replace('watch?v=', 'embed/').split('&')[0];
        return cleanUrl.split('?')[0];
    }
    

return cleanUrl.split('?')[0];
}

// --- Helper: elimina la caja de ficha t√©cnica si la tabla qued√≥ vac√≠a (sin filas) ---
function removeEmptyFichaBlocks(s) {
  try {
    return s.replace(/<div[^>]*>\s*<h3[^>]*>[^<]*Nuestros Productos[^<]*<br>Ficha t√©cnica y especificaciones<\/h3>\s*<table[^>]*>\s*<\/table>\s*<\/div>/gis, '');
  } catch (e) { return s; }
}
</script>
<style>
body { font-family: Calibri, sans-serif; margin: 0; background-color: #f4f6f7; font-size: 14px; }
.header { flex-direction:row; gap:12px; justify-content:center; align-items:center; display:flex;  color: white; padding: 20px; font-size: 28px; text-align: center; font-weight: bold;  background:#000273; }
.card { margin: 20px; background: linear-gradient(180deg, #ffffff, #f8f9fa); border-radius:8px; padding: 20px; box-shadow: 0 3px 10px rgba(0,0,0,0.1); border: 1px solid #ddd; }
h2 { border-bottom: 1px solid #ddd; padding-bottom: 10px; font-size: 20px; }
button { background: linear-gradient(#1f618d, #154360); color: white; border: none; padding: 12px 20px; margin-right: 10px; margin-bottom: 10px; border-radius:8px; cursor: pointer; font-size: 14px; box-shadow: 0 3px 6px rgba(0,0,0,0.1); transition: all 0.2s ease-in-out; }
button:hover { transform: scale(1.02); box-shadow: 0 5px 12px rgba(0,0,0,0.15); }
.visual-id { margin-bottom: 5px; background: #d6eaf8 !important; color: #21618c !important; font-size: 14px !important; padding: 6px 12px !important; border-radius:8px !important; font-weight: bold !important; display: inline-block !important; }
img[alt="Marca"] { max-width: 100px !important; height: auto !important; display: block; margin: 0 auto; }
img[alt="Descripci√≥n"], img[alt="Material"], img[alt="Dimensiones"] { width: 50px !important; height: 50px !important; object-fit: contain !important; display: block; margin: 0 auto; }
img[src=""] { display: none; }
table td { max-width: 140px; overflow: hidden; vertical-align: middle; text-align: left; }
@media (max-width: 600px) {
  table { width: 100% !important; margin: 0 !important; padding: 0 !important; }
  table tr { display: flex; flex-direction: column; width: 100%; margin: 0; border-bottom: 1px solid #ccc; }
  table td { width: 100% !important; text-align: center !important; padding: 10px 5px; box-sizing: border-box; }
  img[alt="Marca"] { max-width: 100px !important; height: auto !important; display: block; margin: 0 auto; }
  img[alt="Descripci√≥n"], img[alt="Material"], img[alt="Dimensiones"] { width: 50px !important; height: 50px !important; object-fit: contain !important; display: block; margin: 0 auto; }
}
.easy-ficha-wrapper * { all: revert; box-sizing: border-box; }
.video-container { width: 100% !important; display: block; margin: 0 auto;   }
.video-container iframe { width: 100% !important;   display: block; }
br.pre-h4{display:block;margin:0 0 0 0;}
.ul-text{list-style:none;margin:0;padding-left:0;}
.ul-text li{margin:0;line-height:1.6;}
.ul-text li::before{content:"- ";}

/* === Iconos de diferenciadores (bajo descripci√≥n larga) === */
.iconos-wrap {
  display: flex;
  flex-wrap: wrap;
  gap: 12px;
  align-items: center;
  margin: 6px 0 14px 0; /* alineado con padding-left de la descripci√≥n (20px) */
}
.iconos-wrap img {
  width: 60px;
  height: 60px;
  object-fit: contain;
  display: inline-block;
}

/* ensure space under the specs block so it never hugs the video */
.easy-ficha-wrapper .specs-table, 
.easy-ficha-wrapper .specs, 
.easy-ficha-wrapper .tabla, 
.easy-ficha-wrapper .table-wrap {
  padding-bottom: 8px;
}

/* --- Visual-only divider between cards (preview only) --- */
.card-divider{
  height: 1px;
  background: #e9eef3;
  border: 0;
  margin: clamp(18px, 2.5vw, 26px) 0;
  width: 100%;
}


/* --- Divider between rows (visualization only) --- */
.row-divider{
  flex-basis: 100%;
  height: 1px;
  background: #e9eef3;
  margin: clamp(18px, 2.5vw, 26px) 0;
  border: 0;
}

</style>
<style>

/* ==== Responsividad Web / Mobile / App ==== */
@media (max-width: 900px) {
  .header { font-size: 18px;  background:#000273; }
  .card { padding: 14px !important; }
  .easy-ficha-wrapper { display: block !important; }
  /* Bot√≥n de descarga: que ocupe ancho completo en mobile */
  a[style*="background-color:#0057cb"] {
    display: block !important;
    width: 100% !important;
    text-align: center !important;
  }
  /* Tabla responsive: columnas apiladas */
  .card table { width: 100% !important; border-collapse: collapse; }
  .card table tr { display: block; border-bottom: 1px solid #eee; }
  .card table td { display: block; width: 100% !important; padding: 10px 12px !important; }
  /* √çconos m√°s peque√±os en mobile */
  .card img[alt="Material"],
  .card img[alt="Dimensiones"] { width: 40px !important; height: 40px !important; }
}
/* Im√°genes fluidas */
img { max-width: 100%; height: auto; }
/* Video responsive con proporci√≥n 16:9 */
.video-container { position: relative; width: 100%; padding-top: 56.25%; }
.video-container iframe { position: absolute; top: 0; left: 0; width: 100%; height: 100%; }
/* Listas renderizadas desde guiones: margen agradable */
.ul-text { padding-left: 18px; margin: 6px 0; }

</style>

<style>

/* === Unified responsive video (16:9) with rounded corners === */
.video-container{
  position: relative;
  width: 100%;
  padding-top: 56.25% !important; /* override any previous padding */
  margin-top: clamp(24px, 3.5vw, 40px) !important;
  border-radius:8px;
  overflow: hidden;
}
.video-container iframe{
  position: absolute;
  inset: 0;
  width: 100%;
  height: 100% !important; /* override any previous height */
  border: 0;
  display: block;
  border-radius: inherit;
}

</style>
</head>
<body>
<div class="header" style="background:#000273;"><img src="https://cl-paris-media-hub.ecomm.cencosud.com/files/logos_paris/logos_web/Header_Brand_125_60x60.svg?v=1" alt="Paris" style="max-height:40px;height:auto;width:auto;display:block;"/><span>Creador de Descripciones Largas</span></div>
<div class="card">
<h2>üìú Instrucciones</h2>
<ul style="line-height:1.7;">
<li>üë®‚Äçüíª <b>Descargar Plantilla:</b> Usa el bot√≥n para descargar un Excel preformateado.</li>
<li>üìÅ <b>Procesar Excel:</b> Completa los campos requeridos.</li>
<li>üëÅÔ∏è <b>Previsualizar:</b> Visualizar Tablas muestra resultados.</li>
<li>‚¨áÔ∏è <b>Exportar:</b> Exportar HTML a Excel descarga resultados.</li>
</ul>
<div style="background: #fff9e6; border-left: 6px solid #f5c518; border-top-left-radius: 12px; border-bottom-left-radius: 12px; padding: 20px; margin-bottom: 30px;">
  <h3 style="margin-top: 0; color: #7d6608;">üìå <b>Directrices</b></h3>
  <ul style="line-height:1.7; color: #000; margin: 0;"><li><b>Descripci√≥n corta:</b> M√°ximo 160 caracteres.</li>
<li><b>Descripci√≥n larga:</b> Este campo se convierte en texto HTML. Usa palabras *entre asteriscos* para poner en negrita, y ## antes de t√≠tulos para destacarlos.</li>
<li><b>Descripci√≥n de la Marca:</b> Usa el archivo "Descripciones Marcas y urls" desde SharePoint.</li>
<li><b>Imagen de Marca:</b> Agrega el nombre de la imagen m√°s la extensi√≥n, Ej. logoBC.png (acepta .jpg, .jpeg, .png, .webp ‚úÖ). Debe estar alojada en Filezilla &gt; Carpeta Logos (M√°x 60 px de alto)</li>
<li><b>Video YouTube:</b> Se acepta tanto la URL corta como la larga para incrustar videos.</li>
<li><b>Descarga de documentos:</b> Selecciona en el Excel el bot√≥n que se acomode a tu necesidad m√°s la URL del archivo.</li>
<li>En la plantilla descargada podr√°s ver las instrucciones en mayor detalle</li></ul>
</div>
<button onclick="updateTables()">üëÅÔ∏è Visualizar Tablas</button>
<button onclick="exportHtmlToExcel()">‚¨áÔ∏è Exportar HTML a Excel</button>
<button id="btnDescargarPlantilla" onclick="downloadTemplate()">üìÑ Descargar Plantilla</button> <span id="tplStatus" style="font-size:12px;color:#555;margin-left:8px;display:none;"></span>
<button onclick="limpiarTodo()">üßπ Limpiar Todo</button>
<input accept=".xlsx" id="importFile" onchange="importExcel()" type="file"/>
</div>
<div class="card" id="tablesContainer"></div>
<script>

const defaultImagenes = {
  descripcion: "https://cl-gm-original-files.ecomm.cencosud.com/is/image/EasySA/logo_producto.png",
  material:     "https://cl-gm-original-files.ecomm.cencosud.com/is/image/EasySA/logo_material.png",
  dimensiones:  "https://cl-gm-original-files.ecomm.cencosud.com/is/image/EasySA/logo_dimensiones.png"
};

let excelRows = [];

function importExcel() {
  const file = document.getElementById('importFile').files[0];
  if (!file) return alert('Por favor selecciona un archivo Excel.');
  const reader = new FileReader();
  reader.onload = function(e) {
    const data = new Uint8Array(e.target.result);
    const workbook = XLSX.read(data, {type: 'array'});
    const sheet = workbook.Sheets[workbook.SheetNames[0]];
    excelRows = XLSX.utils.sheet_to_json(sheet, { defval: "", raw: false });
    if (!excelRows.length) return alert('‚ùå No se encontraron filas en el Excel.');
    alert('üìÅ Excel cargado correctamente. Puedes visualizar las tablas.');
  };
  reader.readAsArrayBuffer(file);
}
// Helper para obtener campo por nombre de cabecera, tolerante a variantes
function get(row, keys) {
  for (const k of keys) {
    if (k in row && row[k] !== undefined && row[k] !== null) return String(row[k]);
  }
  return "";
}
function updateTables() {
  const container = document.getElementById('tablesContainer');
  if (!excelRows.length) {
    container.innerHTML = '<p>‚ùå No hay datos cargados. Por favor sube un Excel primero.</p>';
    return;
  }
  let html = '<div class="easy-ficha-wrapper" style="display:flex; flex-wrap:wrap; gap:20px;">';
html = cleanForCSV(html);
  excelRows.forEach((row, index) => {
    const sku = get(row, ['SKU']);
    const marca = get(row, ['Descripci√≥n de la Marca','Descripcion de la Marca','Descripci√≥n Marca']);
    const descripcion = get(row, ['Nombre del Producto','Nombre Producto','Producto']);
    const material = get(row, ['Material']);
    const dimensiones = get(row, ['Dimensiones']);
    console.log('Marca URL (build):', buildMarcaUrl);
    const _rawMarca = cleanCell(get(row, ['URL Imagen Marca','Url Imagen Marca','Imagen de Marca','imagen de marca']));
const imgMarca = buildMarcaUrl(_rawMarca);
    const imgDesc = get(row, ['URL Imagen Descripci√≥n','URL Imagen Descripcion']);
    const imgMaterial = get(row, ['URL Imagen Material']);
    const imgDimensiones = get(row, ['URL Imagen Dimensiones']);
    const descripcionProducto = get(row, ['Descripci√≥n larga','Descripcion larga','Descripci√≥n Larga','Descripcion Larga','Descripci√≥n']);
    const videoUrl = get(row, ['VideoYouTube','Video YouTube','YouTube']);
    const metaDescripcion = get(row, ['Meta Descripci√≥n','Meta Descripcion','Descripci√≥n corta','Descripcion corta']);
    const botonTexto = get(row, ['Archivo Descargable (Bot√≥n)','Archivo Descargable (Boton)','Texto Bot√≥n','Texto Boton']);
    const botonUrl = get(row, ['URL archivo descargable','URL Archivo Descargable','URL bot√≥n','URL Boton','Manual de uso URL']);
    
    const iconos = pickIconValues(row);
const cta = metaDescripcion.trim(); // sin fallback
    const embedUrl = cleanYoutubeUrl(videoUrl);
    let botonHTML = '';
    
    // --- Im√°genes diferenciadoras (Excel: Imagen diferenciadora 1/2/3) ---
    const dif1Name = get(row, ['Imagen diferenciadora 1','Imagen diferenciadora 1 ']);
    const dif2Name = get(row, ['Imagen diferenciadora 2','Imagen diferenciadora 2 ']);
    const dif3Name = get(row, ['Imagen diferenciadora 3','Imagen diferenciadora 3 ']);

    const dif1 = dif1Name ? buildDifUrl(dif1Name) : buildDiferenciadorUrl(sku, 1);
    const dif2 = dif2Name ? buildDifUrl(dif2Name) : buildDiferenciadorUrl(sku, 2);
    const dif3 = dif3Name ? buildDifUrl(dif3Name) : buildDiferenciadorUrl(sku, 3);

    // Bloque 1: debajo de la descripci√≥n corta
    let difBlock1 = '';
    if (dif1) {
      difBlock1 = `
        <div style='margin:16px 0; clear:both;'>
          <img src="${dif1}" alt="" loading="lazy" decoding="async"
               style='width:100%;height:auto;display:block;border-radius:10px;'>
        </div>`;
    }

    // Bloque 2-3: debajo del bot√≥n (dos columnas)
        // Bloque 2-3: debajo del bot√≥n (dos columnas)
    let difBlock23 = '';
    if (dif2 || dif3) {
      difBlock23 = `
        <div style='margin:10px 0 0 0; display:grid; grid-template-columns:repeat(auto-fit, minmax(240px, 1fr)); gap:12px; align-items:start; width:100%; clear:both;'>
          ${dif2 ? `<img src="${dif2}" alt="" loading="lazy" decoding="async" style='width:100%;height:auto;display:block;border-radius:10px;object-fit:contain;'>` : ''}
          ${dif3 ? `<img src="${dif3}" alt="" loading="lazy" decoding="async" style='width:100%;height:auto;display:block;border-radius:10px;object-fit:contain;'>` : ''}
        </div>`;
    }
    
    
    if (botonTexto && botonUrl) {
      botonHTML = `
                <div style='margin: 15px 0;'>
          <a href='${botonUrl}' target='_blank' style='
            display:inline-block; background-color:#0057cb; color:#fff;
            padding:12px 20px; border-radius:6px; font-weight:bold; text-decoration:none;
            box-shadow:0 3px 6px rgba(0,0,0,0.1); transition:all 0.2s ease-in-out;
          ' onmouseover="this.style.boxShadow='0 5px 12px rgba(0,0,0,0.2)'"
             onmouseout="this.style.boxShadow='0 3px 6px rgba(0,0,0,0.1)'">
            ${botonTexto}
          </a>
        </div>`;
    }
    html += `<div style='flex:1 1 400px; margin-bottom:25px; background:#fff; padding: clamp(14px, 2vw, 22px); border:1px solid #eef2f6; border-radius:8px; box-shadow:0 6px 18px rgba(0,0,0,0.08); overflow:hidden;'>
<div class='visual-id'>Ficha N¬∞ ${index + 1}</div>
<div style='display:inline-block; background:#f4f6f7; color:#333; font-size:13px; padding:4px 10px; border-radius:8px; margin-top:6px;'>üì¶ SKU: ${sku}</div>
<h3 style='margin-bottom:0; color:#2c3e50;'>${descripcion}</h3>
${cta ? formatMetaDescripcion(cta) : ''}
${imgMarca ? `<div style='margin:10px 0 0 0;'><img src='${imgMarca}' alt='Imagen de Marca' style='max-height:50px;height:auto;width:auto;display:block;'></div>` : ''}
${difBlock1}
${descripcionProducto ? `<div style='margin:6px 0 15px 0; background:transparent; color:#000; font-size:15px; padding:0; border-radius:8px;'>${formatDescripcionHTML(descripcionProducto)}</div>` : ''}
${marca ? `<div style='margin-bottom:10px; font-size:15px;'>${marca}</div>` : ''}
${renderIconosExport(iconos)}
${botonHTML}${difBlock23}
<div style='margin:20px 0;'></div>
<div style='border:1px solid #ddd; border-radius:8px; background:#fff;'>
<h3 style='background: #2C3E50;color:white;padding:15px;margin:0; text-align:center; border-radius:8px 8px 0 0;'>Nuestros Productos<br>Ficha t√©cnica y especificaciones</h3>
<table style='width:100%; border-collapse:collapse;'>`;
    if (material) html += `<tr style='border-bottom:1px solid #e5e7eb;'><td style='width:84px; padding:18px 12px; text-align:center; border-right:1px solid #e5e7eb; vertical-align:middle;'><img src='${imgMaterial || defaultImagenes.material}' alt='Material'></td><td style='padding:18px 16px; vertical-align:middle;'><b style='font-weight:700;'>Material:</b> ${material}</td></tr>`;
    if (dimensiones && dimensiones.trim() !== '') html += `<tr style='border-bottom:1px solid #e5e7eb;'><td style='width:84px; padding:18px 12px; text-align:center; border-right:1px solid #e5e7eb; vertical-align:middle;'><img src='${imgDimensiones || defaultImagenes.dimensiones}' alt='Dimensiones'></td><td style='padding:18px 16px; vertical-align:middle;'><b style='font-weight:700;'>Dimensiones:</b> ${dimensiones}</td></tr>`;
    html += `</table></div>`;
    if (embedUrl) html += `<div style='position:relative;padding-bottom:56.25%;height:0;overflow:hidden;border-radius:8px;max-width:100%'><iframe style='position:absolute;top:0;left:0;width:100%;height:100%;border:0' loading='lazy' referrerpolicy='strict-origin-when-cross-origin' allow='accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share' height='auto' src='${embedUrl}' frameborder='0' allowfullscreen></iframe></div>`;
    html += `</div>`;
  
    /* divider after each row of 3 cards (visual only) */
    if (((index + 1) % 3) === 0 && index < excelRows.length - 1) {
      html += `<div class="row-divider"></div>`;
    }
});
  html += '</div>';
  container.innerHTML = removeEmptyFichaBlocks(html);
}
function exportHtmlToExcel() {
  if (!excelRows.length) return alert('‚ùå No hay datos cargados para exportar.');
  const data = [['SKU', 'Descripci√≥n Larga/Emocional']];
  excelRows.forEach((row) => {
    const sku = get(row, ['SKU']);
    const marca = get(row, ['Descripci√≥n de la Marca','Descripcion de la Marca','Descripci√≥n Marca']);
    const descripcion = get(row, ['Nombre del Producto','Nombre Producto','Producto']);
    const material = get(row, ['Material']);
    const dimensiones = get(row, ['Dimensiones']);
    const imgMarcaRaw = get(row, ['URL Imagen Marca','URL Imagen Marca ']);
    const imgMarca = buildMarcaUrl(cleanCell(imgMarcaRaw));
    const imgDesc = get(row, ['URL Imagen Descripci√≥n','URL Imagen Descripcion']);
    const imgMaterial = get(row, ['URL Imagen Material']);
    const imgDimensiones = get(row, ['URL Imagen Dimensiones']);
    const descripcionProducto = get(row, ['Descripci√≥n larga','Descripcion larga','Descripci√≥n Larga','Descripcion Larga','Descripci√≥n']);
    const videoUrl = get(row, ['VideoYouTube','Video YouTube','YouTube']);
    const metaDescripcion = get(row, ['Meta Descripci√≥n','Meta Descripcion','Descripci√≥n corta','Descripcion corta']);
    const botonTexto = get(row, ['Archivo Descargable (Bot√≥n)','Archivo Descargable (Boton)','Texto Bot√≥n','Texto Boton']);
    const botonUrl = get(row, ['URL archivo descargable','URL Archivo Descargable','URL bot√≥n','URL Boton','Manual de uso URL']);
    
    const iconos = pickIconValues(row);
const cta = metaDescripcion.trim(); // sin fallback
    const embedUrl = cleanYoutubeUrl(videoUrl);
    let botonHTML = '';
    // --- Im√°genes diferenciadoras (Excel: Imagen diferenciadora 1/2/3) ---
    const dif1Name = get(row, ['Imagen diferenciadora 1','Imagen diferenciadora 1 ']);
    const dif2Name = get(row, ['Imagen diferenciadora 2','Imagen diferenciadora 2 ']);
    const dif3Name = get(row, ['Imagen diferenciadora 3','Imagen diferenciadora 3 ']);

    const dif1 = dif1Name ? buildDifUrl(dif1Name) : buildDiferenciadorUrl(sku, 1);
    const dif2 = dif2Name ? buildDifUrl(dif2Name) : buildDiferenciadorUrl(sku, 2);
    const dif3 = dif3Name ? buildDifUrl(dif3Name) : buildDiferenciadorUrl(sku, 3);
    console.log('DIF URLs:', dif1, dif2, dif3);

    let difBlock1 = '';
if (dif1) {
  difBlock1 = `
    <div style='margin:16px 0; clear:both;'>
      <img src="${dif1}" alt="" loading="lazy" decoding="async"
           style='width:100%;height:auto;display:block;border-radius:10px;'>
    </div>`;
}

let difBlock23 = '';
if (dif2 || dif3) {
  difBlock23 = `
    <div style='margin:10px 0 0 0; display:grid; grid-template-columns:repeat(auto-fit, minmax(240px, 1fr)); gap:12px; align-items:start; width:100%; clear:both;'>
      ${dif2 ? `<img src="${dif2}" alt="" loading="lazy" decoding="async" style='width:100%;height:auto;display:block;border-radius:10px;object-fit:contain;'>` : ''}
      ${dif3 ? `<img src="${dif3}" alt="" loading="lazy" decoding="async" style='width:100%;height:auto;display:block;border-radius:10px;object-fit:contain;'>` : ''}
    </div>`;
}

    
    if (botonTexto && botonUrl) {
      botonHTML = `
                <div style='margin: 15px 0;'>
          <a href='${botonUrl}' target='_blank' style='
            display:inline-block; background-color:#0057cb; color:#fff;
            padding:12px 20px; border-radius:6px; font-weight:bold; text-decoration:none;
            box-shadow:0 3px 6px rgba(0,0,0,0.1); transition:all 0.2s ease-in-out;
          ' onmouseover="this.style.boxShadow='0 5px 12px rgba(0,0,0,0.2)'"
             onmouseout="this.style.boxShadow='0 3px 6px rgba(0,0,0,0.1)'">
            ${botonTexto}
          </a>
        </div>`;
    }
    let html = `<div style='margin-bottom:25px;
<h3 style='margin-bottom:0; color:#2c3e50;'>${descripcion}</h3>
${cta ? formatMetaDescripcion(cta) : ''}
${imgMarca ? `<div style='margin:10px 0 0 0;'><img src='${imgMarca}' alt='Imagen de Marca' style='max-height:50px;height:auto;width:auto;display:block;'></div>` : ''}
${difBlock1}
${descripcionProducto ? `<div style='margin:6px 0 15px 0; background:transparent; color:#000; font-size:15px; padding:0; border-radius:8px;'>${formatDescripcionHTML(descripcionProducto)}</div>` : ''}
${marca ? `<div style='margin-bottom:10px; font-size:15px;'>${marca}</div>` : ''}
${renderIconosExport(iconos)}
${botonHTML}
${difBlock23}
<div style='margin:20px 0;'></div>
<div style='border:1px solid #ddd; border-radius:8px;'>
<h3 style='background: #2C3E50;color:white;padding:15px;margin:0; text-align:center;'>Nuestros Productos<br>Ficha t√©cnica y especificaciones</h3>
<table style='width:100%; border-collapse:collapse;'>`;
html = cleanForCSV(html);
    if (material) html += `<tr style='border-bottom:1px solid #e5e7eb;'><td style='width:84px; padding:18px 12px; text-align:center; border-right:1px solid #e5e7eb; vertical-align:middle;'><img src='${imgMaterial || defaultImagenes.material}'></td><td style='padding:18px 16px; vertical-align:middle;'><b style='font-weight:700;'>Material:</b> ${material}</td></tr>`;
    if (dimensiones) html += `<tr style='border-bottom:1px solid #e5e7eb;'><td style='width:84px; padding:18px 12px; text-align:center; border-right:1px solid #e5e7eb; vertical-align:middle;'><img src='${imgDimensiones || defaultImagenes.dimensiones}'></td><td style='padding:18px 16px; vertical-align:middle;'><b style='font-weight:700;'>Dimensiones:</b> ${dimensiones}</td></tr>`;
    html += `</table></div>`;
    if (embedUrl) html += `<div style='position:relative;padding-bottom:56.25%;height:0;overflow:hidden;border-radius:8px;max-width:100%'><iframe style='position:absolute;top:0;left:0;width:100%;height:100%;border:0' loading='lazy' referrerpolicy='strict-origin-when-cross-origin' allow='accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share' height='auto' src='${embedUrl}' frameborder='0' allowfullscreen></iframe></div>`;
    html += `</div>`;
    html = removeEmptyFichaBlocks(html);
    data.push([sku, cleanForCSV(html)]);
  });
  const ws = XLSX.utils.aoa_to_sheet(data);
  const wb = XLSX.utils.book_new();
  XLSX.utils.book_append_sheet(wb, ws, 'Descripciones');
  XLSX.writeFile(wb, 'descripciones_largas_formato_html.xlsx');
}
function limpiarTodo() {
  document.getElementById('importFile').value = '';
  document.getElementById('tablesContainer').innerHTML = '<p>üìÇ Sin datos cargados.</p>';
  excelRows = [];
  alert('üßπ Se limpiaron los datos y las tablas correctamente.');
}
</script>
</body>
</html>